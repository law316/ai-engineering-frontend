<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Image Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top left, #0ea5e9, #020617 50%),
        radial-gradient(circle at bottom right, #22c55e, #020617 50%);
      background-blend-mode: screen;
      color: #f9fafb;
      padding: 20px;
    }

    .float-orbs::before,
    .float-orbs::after {
      content: "";
      position: fixed;
      width: 220px;
      height: 220px;
      border-radius: 999px;
      filter: blur(50px);
      opacity: 0.35;
      z-index: -1;
    }

    .float-orbs::before {
      top: -40px;
      left: -40px;
      background: #22c55e;
    }

    .float-orbs::after {
      bottom: -40px;
      right: -40px;
      background: #3b82f6;
    }

    .container {
      width: 100%;
      max-width: 1000px;
      background: rgba(15, 23, 42, 0.92);
      border-radius: 24px;
      box-shadow: 0 20px 40px rgba(15, 23, 42, 0.7);
      padding: 24px;
      backdrop-filter: blur(14px);
      border: 1px solid rgba(148, 163, 184, 0.25);
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
    }

    .header h1 {
      font-size: 1.8rem;
      margin-bottom: 6px;
    }

    .header p {
      font-size: 0.9rem;
      color: #cbd5f5;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }

    @media (min-width: 800px) {
      .grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .card {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 18px;
      padding: 18px 16px 16px;
      border: 1px solid rgba(148, 163, 184, 0.3);
    }

    .card h2 {
      font-size: 1.1rem;
      margin-bottom: 4px;
    }

    .card small {
      font-size: 0.8rem;
      color: #9ca3af;
    }

    label {
      display: block;
      font-size: 0.8rem;
      margin-top: 12px;
      margin-bottom: 4px;
      color: #e5e7eb;
    }

    textarea,
    input[type="text"] {
      width: 100%;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.9);
      color: #f9fafb;
      padding: 8px 10px;
      font-size: 0.9rem;
      resize: vertical;
    }

    textarea:focus,
    input[type="text"]:focus {
      outline: none;
      border-color: #38bdf8;
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.7);
    }

    input[type="file"] {
      font-size: 0.8rem;
      margin-top: 4px;
      color: #cbd5f5;
    }

    .btn {
      margin-top: 12px;
      width: 100%;
      padding: 9px 12px;
      border-radius: 999px;
      border: none;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      background: linear-gradient(90deg, #22c55e, #3b82f6);
      color: #020617;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: transform 0.1s ease, box-shadow 0.1s ease,
        filter 0.1s ease;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 18px rgba(15, 23, 42, 0.6);
      filter: brightness(1.05);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: default;
      transform: none;
      box-shadow: none;
      filter: none;
    }

    .status {
      margin-top: 10px;
      font-size: 0.8rem;
      min-height: 18px;
    }

    .status.ok {
      color: #4ade80;
    }

    .status.err {
      color: #fca5a5;
    }

    .description-box {
      margin-top: 8px;
      padding: 8px;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 0.82rem;
      color: #e5e7eb;
      white-space: pre-wrap;
      max-height: 180px;
      overflow-y: auto;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 0.7rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: #cbd5f5;
      margin-top: 6px;
    }
  </style>
</head>
<body class="float-orbs">
  <div class="container">
    <div class="header">
      <h1>AI Image Studio</h1>
      <p>
        Generate images from text or upload an image and let AI describe it.
      </p>
    </div>

    <div class="grid">
      <!-- Generate Image -->
      <div class="card">
        <h2>Generate Image</h2>
        <small>Send a prompt to <code>/api/image/niceimage</code></small>

        <label for="genPrompt">Image prompt</label>
        <textarea
          id="genPrompt"
          rows="4"
          placeholder="e.g. a sleek Java dashboard UI with charts and glowing code blocks"
        ></textarea>

        <button id="genBtn" class="btn">
          <span>Generate image</span>
        </button>

        <div id="genStatus" class="status"></div>
      </div>

      <!-- Describe Image -->
      <div class="card">
        <h2>Describe Uploaded Image</h2>
        <small>Send a file + text to <code>/api/image/imageupload</code></small>

        <label for="descText">What do you want the AI to focus on?</label>
        <textarea
          id="descText"
          rows="3"
          placeholder="e.g. describe the scene and mood in this image"
        ></textarea>

        <label for="descFile">Upload image (JPG/PNG)</label>
        <input type="file" id="descFile" accept="image/*" />

        <button id="descBtn" class="btn">
          <span>Describe image</span>
        </button>

        <div id="descStatus" class="status"></div>

        <div id="descResult" class="description-box" style="display:none;"></div>

        <div class="tag">
          <span>Tip:</span>
          <span>You can say “explain what is happening in this image”.</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    const BASE_URL = "https://aiengineerpractice.fly.dev";

    // --- Generate Image ---
    const genPromptEl = document.getElementById("genPrompt");
    const genBtn = document.getElementById("genBtn");
    const genStatus = document.getElementById("genStatus");

    genBtn.addEventListener("click", async () => {
      const prompt = genPromptEl.value.trim();
      if (!prompt) {
        genStatus.textContent = "Please enter a prompt first.";
        genStatus.className = "status err";
        return;
      }

      genBtn.disabled = true;
      genStatus.textContent = "Generating image...";
      genStatus.className = "status";

      try {
        const res = await fetch(`${BASE_URL}/api/image/niceimage`, {
          method: "POST",
          headers: {
            "Content-Type": "text/plain",
          },
          body: prompt,
        });

        const text = await res.text();

        if (!res.ok) {
          genStatus.textContent = `Error: ${text || res.status}`;
          genStatus.className = "status err";
          return;
        }

        genStatus.textContent = "Success! Image generated on the server.";
        genStatus.className = "status ok";
      } catch (err) {
        console.error(err);
        genStatus.textContent = "Network error while generating image.";
        genStatus.className = "status err";
      } finally {
        genBtn.disabled = false;
      }
    });

    // --- Describe Image ---
    const descTextEl = document.getElementById("descText");
    const descFileEl = document.getElementById("descFile");
    const descBtn = document.getElementById("descBtn");
    const descStatus = document.getElementById("descStatus");
    const descResult = document.getElementById("descResult");

    descBtn.addEventListener("click", async () => {
      const describe = descTextEl.value.trim();
      const file = descFileEl.files[0];

      if (!describe) {
        descStatus.textContent = "Please enter a description prompt.";
        descStatus.className = "status err";
        return;
      }

      if (!file) {
        descStatus.textContent = "Please select an image file.";
        descStatus.className = "status err";
        return;
      }

      const formData = new FormData();
      formData.append("describe", describe);
      formData.append("file", file);

      descBtn.disabled = true;
      descStatus.textContent = "Uploading & asking AI...";
      descStatus.className = "status";
      descResult.style.display = "none";
      descResult.textContent = "";

      try {
        const res = await fetch(`${BASE_URL}/api/image/imageupload`, {
          method: "POST",
          body: formData,
        });

        const text = await res.text();

        if (!res.ok) {
          descStatus.textContent = `Error: ${text || res.status}`;
          descStatus.className = "status err";
          return;
        }

        descStatus.textContent = "Success! AI returned a description.";
        descStatus.className = "status ok";

        descResult.style.display = "block";
        descResult.textContent = text;
      } catch (err) {
        console.error(err);
        descStatus.textContent = "Network error while describing image.";
        descStatus.className = "status err";
      } finally {
        descBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
